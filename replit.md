# AgroMind - Платформа агро-интеллекта

## Обзор проекта
AgroMind - это комплексная платформа для управления сельским хозяйством, объединяющая мониторинг погоды в реальном времени с ИИ-консультантом на базе Google Gemini. Платформа предназначена для фермеров, агрономов и специалистов по животноводству в Казахстане.

## Текущее состояние
**Дата последнего обновления**: 8 ноября 2024 г.

**Основные функции**:
- ✅ Аутентификация через Replit Auth (поддержка Google, GitHub, email)
- ✅ Выбор роли пользователя при первом входе (Фермер, Агроном, Специалист по животноводству)
- ✅ Спутниковая карта с центром на Казахстане
- ✅ Инструменты для рисования и добавления полей на карте
- ✅ Мониторинг погоды через OpenWeather API
- ✅ ИИ-консультант на базе Google Gemini
- ✅ Раздел управления полями
- ✅ Раздел мониторинга животноводства
- ✅ Полная локализация на русский язык

## Архитектура

### Технологии
**Frontend**:
- React 18 + TypeScript
- Vite для сборки
- Wouter для роутинга
- TanStack Query для управления состоянием
- Tailwind CSS + shadcn/ui для UI компонентов
- Leaflet для карт со спутниковыми снимками

**Backend**:
- Node.js + Express
- PostgreSQL (Neon) база данных
- Drizzle ORM
- Replit Auth для аутентификации
- WebSocket поддержка

**Сервисы**:
- Google Gemini API - ИИ-консультант
- OpenWeather API - погодные данные
- Esri World Imagery - спутниковые снимки

### Структура базы данных
- `users` - пользователи с ролями
- `fields` - сельскохозяйственные поля
- `weather_alerts` - погодные оповещения
- `livestock_groups` - группы животных
- `sessions` - сессии пользователей

## Страницы и маршруты

### Главная страница (/)
- Обзор погоды для всех полей
- Карта с расположением полей (спутниковый вид, центр на Казахстане)
- ИИ-чат консультант
- Статистика по полям
- Мониторинг ресурсов
- Мониторинг животноводства

### Поля (/fields)
- Список всех полей пользователя
- Добавление новых полей через форму или рисование на карте
- Информация о каждом поле (площадь, культура, координаты, NDVI, влажность)
- Удаление полей
- Интерактивная спутниковая карта с инструментами рисования

### Животноводство (/livestock)
- Мониторинг групп животных
- Отслеживание температуры и влажности
- Оповещения о тепловом стрессе
- Рекомендации по уходу
- Статистика по всем группам

## Настройка окружения

### Необходимые секреты
```
GEMINI_API_KEY - API ключ Google Gemini для ИИ-консультанта
OPENWEATHER_API_KEY - API ключ OpenWeather для погодных данных
DATABASE_URL - URL подключения к PostgreSQL (автоматически)
SESSION_SECRET - Секрет для сессий (автоматически)
REPL_ID - ID Replit проекта (автоматически)
```

### Установка
```bash
npm install
npm run db:push  # Инициализация базы данных
npm run dev      # Запуск в режиме разработки
```

### Развертывание
Проект настроен для автоматического развертывания на Replit:
```bash
npm run build    # Сборка для production
npm run start    # Запуск production сервера
```

## Особенности реализации

### Карты
- Используется Esri World Imagery для спутниковых снимков
- Карта центрирована на координатах Казахстана (48.0196, 66.9237)
- Leaflet Draw для инструментов рисования полей
- Автоматический расчет площади нарисованных полей

### Аутентификация
- Replit Auth поддерживает вход через Google, GitHub, X, Apple и email
- При первом входе пользователь выбирает роль
- Роль влияет на отображаемый интерфейс

### ИИ Функции
- Gemini 1.5 Flash для быстрых ответов
- Контекстно-зависимые рекомендации на основе погоды и данных полей
- Анализ условий полей

## Недавние изменения

### 8 ноября 2025 - Революционные фишки для хакатона
- ✅ **AI Анализ Области** - Инструмент для выделения произвольной области на карте с полным AI-анализом
- ✅ **Спутниковый NDVI Индекс** - Реал-тайм анализ здоровья растительности через спутниковые данные
- ✅ **AI Прогноз Урожайности** - Предсказание урожайности на основе текущих показателей NDVI и погоды
- ✅ **Детекция Рисков Болезней** - AI оценка условий для патогенов и грибковых заболеваний
- ✅ **Оценка Качества Почвы** - Анализ плодородности и рекомендации по удобрениям
- ✅ **Динамическое Управление Рисованием** - Улучшенные инструменты карты с правильной очисткой ресурсов
- ✅ Исправлен критический баг с null value в поле role при первом входе

### 8 ноября 2024
- Полная локализация на русский язык
- Добавлен диалог выбора роли при первом входе
- Обновлена карта на спутниковые снимки с центром на Казахстане
- Добавлены инструменты для рисования полей
- Создана страница управления полями
- Создана страница мониторинга животноводства
- Добавлена навигация между разделами
- Обновлена схема базы данных для животноводства
- Настроена конфигурация развертывания

## Пользовательские предпочтения
- Язык интерфейса: Русский
- Регион: Казахстан
- Тип карты: Спутниковые снимки
- Аутентификация: Google OAuth (через Replit Auth)

## Планы развития
- [ ] Интеграция дополнительных агро-API (индексы NDVI, качество почвы)
- [ ] Прогнозирование урожайности на основе ИИ
- [ ] Мобильное приложение
- [ ] Экспорт данных и отчетов
- [ ] Интеграция с IoT датчиками полей
- [ ] Система уведомлений (email, SMS)
- [ ] Многопользовательские фермы

## Известные проблемы
- Данные NDVI и влажности почвы пока используют mock-значения (требуется интеграция с API)
- График потребления корма для животных в разработке
- Требуется интеграция с реальными датчиками температуры для животноводства

## Контакты и поддержка
Проект работает на платформе Replit с использованием бесплатных API для разработки и тестирования.
